language: python
install: true
services:
- docker
jdk:
- oraclejdk8
addons:
  sonarcloud:
    organization: maartengdev-github
    token:
      secure: B1hhZPhKeEI9JYjwcmpk78LiEnm2e+Y9yE3O6lAoKeTEWbPtVjm4L1mLHj71HPHrsTk/PO1rTn8jsmb2M+zYXfRNc1gTmJ+9+jWogZC/vqOPSE295SzSuOMxAdzWVCDA9tuecKbrB2OkEovy/W2E2/waaUP2R/wAKLSUvxm/iKOBWeItEVLWCp2SGLBZnuVaUBSBDXCoNjll8LhHzRqAdxAkIBFFB9xBygCfhJnQNUBJRxtzryL3beVigENwcabXKBx53Bc35RS6pYeId3ZYnFhjy5XpMv7NmoHYUGMwwR0eH5aHYg3jWDzXHNCJ3xNDFqfPA1SZZ4Unx69JEqbRI2t+C9vY6yg1bYfeEtuHS25H2obPGwnLTaHaZyiE2HSYdnckU89EyItRJjGiU/sabKORlACo+G6DMrw5pFCaKfIIEEf2hu7BWcf0T8KfteShqmw8/ge/9LrPhgeo+BRe9pr8qfaMR/OHuZrfkiGEPX8Wo5njqM5BiusfrfuUj+6G1bLie6BZS+xax+0iX0mvam+UqhEC2EowkUihLGbPKovX0E2q27tXCwVXpKUkIpFuSubzDbAx9xhAbLiVbWCJzAP7kbxwIXAdIi57Jq6i9ng4zONxLVNMEPNjJSdyZka06M8sXK6y092EQgh9LRGwXMZFJEfgm5HPb6uLkRDISrw=
script:
- mvn clean org.jacoco:jacoco-maven-plugin:prepare-agent package sonar:sonar
- mvn package

after_success:
- docker --version
- pip install awscli
- export PATH=$PATH:$HOME/.local/bin
- eval $(aws ecr get-login --no-include-email --region eu-west-1)
- docker build -t $REPO . -f app.Dockerfile
- docker tag $REPO:latest $AWS_ACCOUNT_NUMBER.dkr.ecr.eu-west-1.amazonaws.com/$REPO:latest
- docker push $AWS_ACCOUNT_NUMBER.dkr.ecr.eu-west-1.amazonaws.com/$REPO:latest

env:
  global:
  - secure: kY8D18FdyV5vRvgWyHPvXoSaYMUmfxOGGsXEJiIHFR6es0mQU1qoOfNx9Igq6IBWr0h/+HD+zNlqnxChX13tGLZc6iwb33E67nCrjYLyKfqj/P0JrarQ8emMs4pmy/gcW05Ba0XUYSrNyizG3jwVlfcy3YpjwDqDFjQ/ST9gxEciATduVBRLYKNpQc3iOUJxs9SveeIQNAEbvp+k2bhK+6jy8LAnbikoKol2GQfjLKKv5Y/gbBYJVdou+ZOdtZwMD+BX7jL23+9s9+F0W4julxhfam6nU7vV66eBTAg0CS1HBzLUFegNn9CuF132qntLBsvYlQpRaZCLhd1bWpyy78N58FG9j7Zd/gU9uBf9JXGwBXJE4vi/NDeNBEaTN5RW1xhzleENCqC5HP4eRf/x5d41BoAjDhDvY/BPQ4wb4rEphB+3nugETR/xUYap8Z1Jj0UqleYpWqqfBeV9fKYIgqvyUzCKVY1JWbcbkuEXKBfQ7IcvHIhRjJrAuYsL02YJOnQ5T1GqmTjdz+EnIx5pBVwOMTTgZunY/Xidcm1kmmm9d5BMGW0Dciayejz30GB0p2EdqApVtIFN2M7GNA+Oi6rRoV+VnmxLETOoWry2QVG3Fi2ezcs7Ww7MVTdcYCZct1HXKAKM+K5+4949q0UEXhDQPwLrmL0y9hII3Lx5Dc8=
  - secure: d3Cv3CLoAUFz0FvK/jCasZzWTqd4jmk6h3r8ihgjXHx0qudiwdpicErRsSDISN5mr9u6ZJOuC4oncBMSM9eqr2ICjXVN25fHtsWw7j11fQnZcVMFUYopL+cpt7GQ/nIh+J5EWrgw/s1GXpqlfz4yFAw8+GoYXzWWUws8g4d1qMIQq5XxFqbO2w8e43iz43oBoTyiG9sd1GaMOGk4d0Xhki6+Ki3EzzKSIWIvMqgfQyYkFACTmZc5jpHrRz3OWF1PsyBDfrL9fVhlVfz2PQrLS30hcVEQJanwsq9huxfIQmE9cw2+HXxNxnVBi4/Vr7/u8OWZ4is6TNB4n0ohvdAbMU/9wGWlzHiXSmspVWRcGyryipd2hdDjyCcZg0KbBMb6urOc42mWjr30n7Kw+ibYnjl/DVrJc7pBxds8ebacYHQra0ZPPFIu6+9GSP9OmP5vKLQg9riQHVIb7ILTzCVDnBbGB2U79WGdLjX09KZVsUK4h8Qsjq0kADW/TtDS271NOW6TD77RsbnqgpfQbtXmGgVOLcVlR12uVFyXvTbXO2mZT6fDWCNEw/avL4VmmX5AbjRgGQRrYzDweNTdDvsfKMarFVRTK89E3ShDB/j+wltSQh7zg48GmVVU4y9hcNxXdH/LubQ1QKtyo/uWWlpaQXQITyjRxVL7hAKwps37uRw=
  - secure: W6/ASZ1Ic5SslnLblQ2SMQiH02JTXqu6eEbBCCGe+FDJ+6RkfmsLOoJWwvcoZFQlMvljzJLWDCfXv2YVqPTanVTEJN2JxgS+f2CUL9gsivlj3/F+YrKF78kBSB+VJsUnY3/8w+7xP5H6NHJIzRtswHhkiLjP5y4hL7Pa1WkFiJCjp9zvwdY7nswIgLGc7gL+vhDyWsTn976NYxry4UizJRTnQnxJsVcE2pJ0+4mg5LYqE9yjcBHvUUFn6ZYL0gNi1QnvuZb0wZVsbwQSt1oZvFcei+0z4EeGJClqm43x1aa5q3cMxSCbl785rTxNzv5+l2i3xCB1/eyJ5vEDron9nEYrirnd37Tj2AFQyGMSMDz5VQl1FetjLms2MjnZaybu+wExJIQ6b5Gr8MRb5wwO5jZQ3GPFh+hP4IM9rrv4fiZLCIKcKyrh6T8lNh5h6/mgGJsFDvVQRQh1aN2FKyMPlwHVIR5yo6fo5Kdu/jysL19qWTQJij62zCcw/7mjroRs4Dknsg1Gjh7JpDgAKZj0lGZzgfVcF+wbgfN4tJK1uAEayPS+rL8niANqkbEO5g5LB1c5kW/4H7AT5owwPshwbJvvJXrtWIYzzewxXZW0+eopiUK+iU9BzWCCyk/QCy30ewF7lYWBp3Wvj2cyuMBNPdeTzsIPKvB4XNB3O4eddQs=
  - secure: GDmJqyTT/8na4j6NMSoj2UpWGViadHamqjaxGQRRvPH1jQyy6L5UYvVOUkOF6/ptk0lJloF5dIPrni/4yKlW6ohrKvBYjT4ob34UaMvE86lNGm5mj5rGZH6WvjBcYYyI+/KKkrekowrlR0rd6c8YoF1GuZ+GsFovIL5GyWagMhZUlkZSoI7VmgQNDCRzekS123ZXrspsq51+1lCIlnSmb7sNVXJWaUxvA2zyHvS4jJNl4E+df2rZoyy1o+HmbwBYvFjfNdXSiMTME/loYu0D+2zX2mX2sakMISBh9cV7GIzNc/BO6onFbPXxRNhSBdCJnyXvZUYaPIHkh/8yI+ClAkW1cRQdplHqJGv05dPUheK9RhQlkV/7dLhWNTe4T3SDHyr98TApEe9GnKRi4a5k8xSM5H188FNApqqABhkyB9Cz9tUAei8Xif28azN6rODvLfPEGC+Q+bCIFTR5M7sv4MkCuDi/biQHYCFtliun5eMhtdt7OYBdKdhMIVYDxT/kDgLpJ9fVqKv32coTShg4S01eOfr6sYiDS+rugp9RqUOAy7wPQFWD6Rkj8UKF+1sijRXpoJD0Y/D53jo8RdtkXIcjl/xM3Z0IFhERyv8eL6kmXo/a1jfB73L/IFWyR4iGtlCTBCazrD71oh6KyR2dIPotb6+CViFzdao4SQhy7dU=
